# hl-agent configuration example
# Copy this file to config.toml and customize for your deployment.

[node]
# Unique identifier for this agent instance (used in sorter metadata)
node_id = "hl-agent-1"

# Path to Hyperliquid node data directory (supports ~ expansion)
data_dir = "~/hl-data"

[watcher]
# Paths to watch for new files (relative to node.data_dir or absolute).
# These correspond to Hyperliquid's output directories.
watch_paths = [
    "replica_cmds",                    # Blocks + transactions
    "node_fills_by_block",            # Fill data (produces fills + trades)
    "node_order_statuses_by_block",   # Order status data
    "misc_events_by_block"            # Miscellaneous node events
]

# Polling interval in milliseconds (default: 100)
poll_interval_ms = 100

# Skip historical data and only process new data after startup (default: true)
# - true : Start tailing from the end of existing files (prevents OOM on first boot)
# - false: Reprocess all historical data (useful for manual backfills)
skip_historical = true

[sorter]
# Choose ONE output mode:
# 1) gRPC sorter:
endpoint = "http://127.0.0.1:50051"
# 2) Local file output (uncomment instead of endpoint):
# output_dir = "/var/lib/hl-agent/output"

# Batch size for sending records (default: 100)
batch_size = 100

[checkpoint]
# SQLite checkpoint database used for crash recovery
# (Tracks per-file offsets so processing resumes where it left off)
db_path = "~/.hl-agent/checkpoint.db"

# Redis endpoint for reading block hashes from ws-agent (defaults to redis://127.0.0.1:6379)
# The ws-agent binary subscribes to the Explorer WebSocket and stores block hashes in Redis.
# hl-agent reads from Redis to enrich blocks with their hashes.
redis_url = "redis://127.0.0.1:6379"

[performance]
# Maximum number of concurrent file tailer tasks (default: 64)
# max_concurrent_tailers = 64

# Warn/abort thresholds for large MessagePack files (defaults: 500 MiB / 1 GiB)
# bulk_load_warn_bytes = 524288000
# bulk_load_abort_bytes = 1073741824

# Retry behavior for sorter send failures (defaults: 5 attempts, 500ms base backoff)
# sink_retry_max_attempts = 5
# sink_retry_base_delay_ms = 500
